
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Statistical Equilibrium Physics &#8212; iPyBBN - An Interactive Overview of Big Bang Nucleosynthesis</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/bigbang.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">iPyBBN - An Interactive Overview of Big Bang Nucleosynthesis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    What is Big Bang Nucleosynthesis?
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="packages.html">
   Appendix A : A note on packages
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Thermodynamics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="thermo.html">
   Thermodynamics and Groundwork
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistical Mechanics and NSE
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="equilibrium_statphys.html">
   Statistical Equilibrium Physics
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/equilibrium_statphys-checkpoint.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fequilibrium_statphys-checkpoint.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/equilibrium_statphys-checkpoint.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#weak-rates-protons-and-neutrons">
   Weak Rates : Protons and Neutrons
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-nuclear-statistical-equlibrium-conditions">
   General Nuclear Statistical Equlibrium Conditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initial-conditions">
   Initial Conditions
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Statistical Equilibrium Physics</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#weak-rates-protons-and-neutrons">
   Weak Rates : Protons and Neutrons
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-nuclear-statistical-equlibrium-conditions">
   General Nuclear Statistical Equlibrium Conditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initial-conditions">
   Initial Conditions
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="statistical-equilibrium-physics">
<h1>Statistical Equilibrium Physics<a class="headerlink" href="#statistical-equilibrium-physics" title="Permalink to this headline">#</a></h1>
<section id="weak-rates-protons-and-neutrons">
<h2>Weak Rates : Protons and Neutrons<a class="headerlink" href="#weak-rates-protons-and-neutrons" title="Permalink to this headline">#</a></h2>
<p>We first consider the equilibrium abundances of protons and neutrons. These are governed by three primary weak interactions between the protons and neutrons, namely:</p>
<div class="math notranslate nohighlight">
\[n + \nu_e \leftrightarrows p + e^-\]</div>
<div class="math notranslate nohighlight">
\[n + e^+ \leftrightarrows p + \overline{\nu}_e\]</div>
<div class="math notranslate nohighlight">
\[n \leftrightarrows p + e^- + \overline{\nu}_e\]</div>
<p>The total reaction rate from n to p and from p to n can be obtained by using statistical mechanics (see Kolb and Turner equation 4.13 for more details). This is already computed for us in Kawano’s 1992 paper, so we will use this instead of delving into the tedious details. This integral is:</p>
<div class="math notranslate nohighlight" id="equation-analytic-np">
<span class="eqno">()<a class="headerlink" href="#equation-analytic-np" title="Permalink to this equation">#</a></span>\[\lambda_{\rm n\rightarrow p} = K \int_{1}^{\infty} {\rm d}x \, \frac{x(x+q)^2(x^2-1)^{1/2}}{(1+e^{-xz})[1+e^{(x+q)z_\nu + \xi_e}]} + \frac{x(x-q)^2(x^2-1)^{1/2}}{(1+e^{xz})[1+e^{-(x-q)z_\nu + \xi_e}]}\]</div>
<p>and the reverse rate is given by <span class="math notranslate nohighlight">\(\lambda_{\rm p \rightarrow n} = \lambda_{\rm n\rightarrow p}(-q, -\xi_e)\)</span>.</p>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(q = (m_n - m_p)/m_e\)</span> is the neutron-proton mass difference divided by the electron mass</p></li>
<li><p><span class="math notranslate nohighlight">\(z = m_ec^2/k_B T_\gamma\)</span> is a substitution</p></li>
<li><p><span class="math notranslate nohighlight">\(z_\nu = m_ec^2/k_B T_\nu\)</span> is the same as <span class="math notranslate nohighlight">\(z\)</span> but for the neutrino temperature</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau\)</span> is the lifetime of a neutron.</p></li>
<li><p><span class="math notranslate nohighlight">\(\xi_e\)</span> is the chemical potential of the electron, taken to be zero but included as a manual override such that non-zero <span class="math notranslate nohighlight">\(\xi_e\)</span> can be evaluated if desired.</p></li>
<li><p><span class="math notranslate nohighlight">\(K\)</span> is a normalization constant that causes the integral to converge to <span class="math notranslate nohighlight">\(\tau\)</span> for low temperatures.</p></li>
</ul>
<p>This is clearly a cumbersome integral, though it can be solved using an IVP solver (we use <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp</span></code>).</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">WeakRateAnalytic</span><span class="p">(</span><span class="n">Tγ</span><span class="p">,</span> <span class="n">T𝜈</span><span class="p">,</span> <span class="n">ξe</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function for computing the weak rates for protons and neutrons.</span>
<span class="sd">    </span>
<span class="sd">    INPUT:</span>
<span class="sd">    T : Temperature matrix of photons and neutrinos in MeV/kB [2 x n ndarray]</span>
<span class="sd">    </span>
<span class="sd">    OUTPUT: </span>
<span class="sd">    lambda_np : Weak rate matrix where the first column is n-&gt;p and the second is p-&gt;n [2 x n ndarray]</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">K</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">τ</span><span class="o">*</span><span class="mf">1.63611486</span><span class="p">)</span> 
    <span class="c1">#K = 1</span>
    <span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Tγ</span><span class="p">,</span> <span class="n">T𝜈</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">):</span>
        
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Internal method returning the integrand of the weak rates.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">((</span><span class="n">me</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tγ</span><span class="o">*</span><span class="n">kB</span><span class="p">))</span>
        <span class="n">z𝜈</span> <span class="o">=</span> <span class="p">((</span><span class="n">me</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T𝜈</span><span class="o">*</span><span class="n">kB</span><span class="p">))</span>
        <span class="n">IntegrandArray</span> <span class="o">=</span> <span class="n">K</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">q</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">z𝜈</span> <span class="o">+</span> <span class="n">ξe</span><span class="p">)))</span> <span class="o">+</span>\
             <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">q</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">z𝜈</span> <span class="o">+</span> <span class="n">ξe</span><span class="p">))))</span>
    
        <span class="k">return</span> <span class="n">IntegrandArray</span>


    <span class="k">def</span> <span class="nf">integration</span><span class="p">(</span><span class="n">Tγ</span><span class="p">,</span> <span class="n">T𝜈</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">ξe</span><span class="o">=</span><span class="n">ξe</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Internal method integrating the integrand from 1 to infinity with resepct to x.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">WeakRate</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">Tγ</span><span class="p">,</span><span class="n">T𝜈</span><span class="p">,</span><span class="n">q</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">WeakRate</span>

    <span class="c1"># Vectorization</span>
    <span class="n">vec_integration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">integration</span><span class="p">)</span>
    
    <span class="n">lambda_np</span> <span class="o">=</span> <span class="n">vec_integration</span><span class="p">(</span><span class="n">Tγ</span><span class="p">,</span> <span class="n">T𝜈</span><span class="p">)</span>
    <span class="n">lambda_pn</span> <span class="o">=</span> <span class="n">vec_integration</span><span class="p">(</span><span class="n">Tγ</span><span class="p">,</span> <span class="n">T𝜈</span><span class="p">,</span> <span class="n">q</span><span class="o">=-</span><span class="n">q</span><span class="p">,</span> <span class="n">ξe</span><span class="o">=-</span><span class="n">ξe</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lambda_np</span><span class="p">,</span> <span class="n">lambda_pn</span>
</pre></div>
</div>
</div>
</div>
<p>Despite the fact that this <em>can</em> be solved this way does not mean that it <em>should</em> be solved this way. We choose to employ an approximation of this integral given in Kawano’s 1992 paper, which is, for a zero or near zero electron degeneracy parameter <span class="math notranslate nohighlight">\(\xi_e\)</span>:</p>
<div class="math notranslate nohighlight">
\[\lambda_{\rm n \rightarrow p} = \frac{1}{\tau} \left(1 + \frac{0.565}{z} - \frac{6.382}{z^2} + \frac{11.108}{z^3} + \frac{36.492}{z^4} + \frac{27.512}{z^5}\right)\]</div>
<p>and for the reverse,</p>
<div class="math notranslate nohighlight">
\[\lambda_{\rm p\rightarrow n} = \frac{1}{\tau} \left(\frac{5.252}{z} - \frac{16.229}{z^2} + \frac{18.059}{z^3} + \frac{34.181}{z^4} + \frac{27.617}{z^5}\right)e^{-qz}\]</div>
<p>While this seems like a somewhat crude polynomial expansion, it allows for a much faster computation time decreasing it by over 2 orders of magnitude from the analytic expression with little error.</p>
<p>We must employ an approximation to make this solve in a reasonable time instead of solving this integral at every time step. Using Kawano’s 1992 work, we employ the following:</p>
<p>Below we define a function using this approximation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">WeakRateApproximate</span><span class="p">(</span><span class="n">Tγ</span><span class="p">):</span>
    
    <span class="n">Z</span> <span class="o">=</span> <span class="p">((</span><span class="n">me</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tγ</span><span class="o">*</span><span class="n">kB</span><span class="p">))</span>
    
    <span class="n">lambda_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">𝜏</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">27.512</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mf">36.492</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="mf">11.108</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mf">6.382</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.565</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">lambda_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">𝜏</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">27.617</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mf">34.181</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="mf">18.059</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mf">16.229</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">5.252</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">Z</span><span class="p">)</span>
    
    <span class="n">lambda_np</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">𝜏</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.565</span><span class="o">/</span><span class="n">Z</span> <span class="o">-</span> <span class="mf">6.382</span><span class="o">/</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">11.108</span><span class="o">/</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">36.492</span><span class="o">/</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">27.512</span><span class="o">/</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">lambda_pn</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">𝜏</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.252</span><span class="o">/</span><span class="n">Z</span> <span class="o">-</span> <span class="mf">16.229</span><span class="o">/</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">18.059</span><span class="o">/</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">34.181</span><span class="o">/</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">27.617</span><span class="o">/</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">Z</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lambda_np</span><span class="p">,</span> <span class="n">lambda_pn</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We note in our temperature regime, they differ by less than 1% for each elemental abundance in the end.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>findfont: Font family [&#39;cursive&#39;] not found. Falling back to DejaVu Sans.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>findfont: Generic family &#39;cursive&#39; not found because none of the following families were found: Apple Chancery, Textile, Zapf Chancery, Sand, Script MT, Felipa, Comic Neue, Comic Sans MS, cursive
</pre></div>
</div>
<img alt="_images/equilibrium_statphys-checkpoint_7_2.png" src="_images/equilibrium_statphys-checkpoint_7_2.png" />
</div>
</div>
<p>This difference seems quite severe, but solving for the actual abundances, we see a minimal divergence.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input tag_remove-output docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">max</span><span class="p">((</span><span class="n">Ynp_an</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">Ynp_app</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">Ynp_an</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">max</span><span class="p">((</span><span class="n">Ynp_an</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Ynp_app</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">Ynp_an</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>For all intents and purposes, this divergence is incredibly minimal in the grand scheme of BBN. This approximation leads to a difference in final abundances of primary reactants as:</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Element</p></th>
<th class="head"><p>Final Abundance Divergence (%)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>D</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-odd"><td><p>T</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p>He-4</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-odd"><td><p>Li-7</p></td>
<td><p>0.4</p></td>
</tr>
</tbody>
</table>
<p>The tradeoff being that the approximation expoentially decreases the computation time for solving the ODE due to its stiffness. Given the same stability parameters, using the analytic result to solve BBN of all the primary light elements takes on the order of 10 to 15 minutes, whereas the approximation lets our ODE solver finish in less than 1 minute.</p>
</section>
<section id="general-nuclear-statistical-equlibrium-conditions">
<h2>General Nuclear Statistical Equlibrium Conditions<a class="headerlink" href="#general-nuclear-statistical-equlibrium-conditions" title="Permalink to this headline">#</a></h2>
</section>
<section id="initial-conditions">
<h2>Initial Conditions<a class="headerlink" href="#initial-conditions" title="Permalink to this headline">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Aidan Meador-Woodruff<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>